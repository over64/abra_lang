# Функции могут возвращать значение или не возвращать
# если функция возвращает Unit?
# для ошибок автоматически захватывается stack trace?

error IOError = (errno: Int, msg: String)

def foo = {
    'foo'.print.?IOError
    'bar'.print.?IOError
}: Unit | IOError

import io = abra.io with IOError

error MainError = IOError | OutOfRange

def main = {
    val array = (1, 2, 3, 4, 5)
    val first = array(0).?OutOfRange
    io.print('a(0) = $first').?IOError
}: Unit | MainError

# hello, world!
import io = abra.io with IOError

def main =
    io.print('Hello world').?IOError


type IOError = (errno: Int, trace: STrace)
def toString = \self: IOError -> '${io.perror(self.errno)} -> \n $trace'

# io
def readline = {
}: String | IOError

def readTwoLines = (l1: io.readline?(), l2: io.readline?()) # (l1: String, l2: String) | IOError
def bar = { s1: String, s2: String ->
    s1 + s2
    # any code
}: String | ConcatErr

def main = {
    val (l1, l2) = readTwoLines?
    bar?(l1, l2)
}